<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pado package &#8212; pado 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pado-package">
<h1>pado package<a class="headerlink" href="#pado-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-pado.complex">
<span id="pado-complex-module"></span><h2>pado.complex module<a class="headerlink" href="#module-pado.complex" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pado.complex.Complex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Complex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">native</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Complex number class for wave optics simulation.</p>
<p>This class provides methods for handling complex numbers and visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>real</strong> (<em>torch.Tensor</em>) – Real part of the complex number</p></li>
<li><p><strong>imag</strong> (<em>torch.Tensor</em>) – Imaginary part of the complex number</p></li>
</ul>
</dd>
</dl>
<p>The class supports the following operations:</p>
<ol class="arabic simple">
<li><p>Basic arithmetic operations</p></li>
<li><p>Visualization methods
- plot_real(): Plot real part
- plot_imag(): Plot imaginary part
- plot_phase(): Plot phase</p></li>
</ol>
<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">native</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.__init__" title="Link to this definition">¶</a></dt>
<dd><dl>
<dt>Tensor of complex numbers. We support three typese of complex-number modes which are all interchangable.</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>Rect</dt><dd><dl class="simple">
<dt>In rect mode, we define the complex number x with real and imaginary parts as</dt><dd><p>x = real + imag*1j</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Polar</dt><dd><dl class="simple">
<dt>In polar mode, we define the complex number x with magnitude and angle as</dt><dd><p>x = mag*exp(1j*ang)</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Native PyTorch</dt><dd><dl class="simple">
<dt>PyTorch recently started supporting complex numbers. We support using the native complex number in Pytorch.</dt><dd><p>x = complex</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ol>
<p>You should select only one mode out of the three options and provide the required components</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>real</strong> – [batch_size, # of channels, row, column] tensor of real values. x = real + 1j * imag</p></li>
<li><p><strong>imag</strong> – [batch_size, # of channels, row, column] tensor of imaginary values. x = real + 1j * imag</p></li>
<li><p><strong>mag</strong> – [batch_size, # of channels, row, column] tensor of magnitude values. x = mag*exp(1j*ang)</p></li>
<li><p><strong>ang</strong> – [batch_size, # of channels, row, column] tensor of angle values. x = mag*exp(1j*ang)</p></li>
<li><p><strong>native</strong> – [batch_size, # of channels, row, column] tensor of native complex values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.get_vis">
<span class="sig-name descname"><span class="pre">get_vis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.get_vis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.get_vis" title="Link to this definition">¶</a></dt>
<dd><p>Return the colorized complex values in numpy based on amplitude and phase.
:param amin: minimum amplitude to visualize
:param amax: maximum amplitude to visualize</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy-based rgb visualization of the complex tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vis</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.dim" title="Link to this definition">¶</a></dt>
<dd><p>Return the dimension of the tensor
:returns: dim</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.get_mag">
<span class="sig-name descname"><span class="pre">get_mag</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.get_mag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.get_mag" title="Link to this definition">¶</a></dt>
<dd><p>Return the magnitude of the complex tensor
:returns: magnitude in the polar representation of the complex number
:rtype: mag</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.get_ang">
<span class="sig-name descname"><span class="pre">get_ang</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.get_ang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.get_ang" title="Link to this definition">¶</a></dt>
<dd><p>Return the angle of the complex tensor
:returns: angle in the polar representation of the complex number
:rtype: ang</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.get_real">
<span class="sig-name descname"><span class="pre">get_real</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.get_real"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.get_real" title="Link to this definition">¶</a></dt>
<dd><p>Return the real part of the complex tensor
:returns: real part in the rect representation of the complex number
:rtype: real</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.get_imag">
<span class="sig-name descname"><span class="pre">get_imag</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.get_imag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.get_imag" title="Link to this definition">¶</a></dt>
<dd><p>Return the imaginary part of the complex tensor
:returns: imaginary part in the rect representation of the complex number
:rtype: imag</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.get_native">
<span class="sig-name descname"><span class="pre">get_native</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.get_native"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.get_native" title="Link to this definition">¶</a></dt>
<dd><p>Return the native complex number of pytorch
:returns: native</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.set_mag">
<span class="sig-name descname"><span class="pre">set_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.set_mag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.set_mag" title="Link to this definition">¶</a></dt>
<dd><p>Set the magnitude of the complex tensor
:param mag: magnitude in the polar representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.set_ang">
<span class="sig-name descname"><span class="pre">set_ang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ang</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.set_ang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.set_ang" title="Link to this definition">¶</a></dt>
<dd><p>Set the angle of the complex tensor
:param ang: angle in the polar representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.set_real">
<span class="sig-name descname"><span class="pre">set_real</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.set_real"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.set_real" title="Link to this definition">¶</a></dt>
<dd><p>Set the real part of the complex tensor
:param real: real part in the rect representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.set_imag">
<span class="sig-name descname"><span class="pre">set_imag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.set_imag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.set_imag" title="Link to this definition">¶</a></dt>
<dd><p>Set the imaginary part of the complex tensor
:param imag: imaginary part in the rect representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.to_rect">
<span class="sig-name descname"><span class="pre">to_rect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.to_rect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.to_rect" title="Link to this definition">¶</a></dt>
<dd><p>Change the current mode to rect</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.to_polar">
<span class="sig-name descname"><span class="pre">to_polar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.to_polar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.to_polar" title="Link to this definition">¶</a></dt>
<dd><p>Change the current mode to polar</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.to_native">
<span class="sig-name descname"><span class="pre">to_native</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.to_native"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.to_native" title="Link to this definition">¶</a></dt>
<dd><p>Change the current mode to native</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of the complex tensor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.size" title="Link to this definition">¶</a></dt>
<dd><p>Returns the size of the complex tensor
:param dim: size of a specific dimension or the entire dimension</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.pad_zero">
<span class="sig-name descname"><span class="pre">pad_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.pad_zero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.pad_zero" title="Link to this definition">¶</a></dt>
<dd><p>Pad zeros to the complex tensor by pad_Width
:param pad_width: (tuple) pad width of the tensor following torch functional pad</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crop_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.crop" title="Link to this definition">¶</a></dt>
<dd><p>Crop the complex tensor by crop_width
:param crop_width: (tuple) crop width of the tensor following torch functional pad</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.__getitem__" title="Link to this definition">¶</a></dt>
<dd><p>indexing the complex tensor with key
:param key: index to the complex number</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>complex number to return</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>complex number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.reshape" title="Link to this definition">¶</a></dt>
<dd><p>Reshape the complex tensor
:param new_shape: shape</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.resize">
<span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.resize" title="Link to this definition">¶</a></dt>
<dd><p>Resize the complex tensor
:param scale_factor: scale factor for the interpolation
:param interp_method: interpolation method used in torch.nn.functional.interpolate ‘bilinear’, ‘nearest’</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.cat">
<span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.cat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.cat" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate another complex tensor to the current complex tensor
:param other: another complex tensor to be concatenated
:param dim: dimension to concatenate</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.__matmul__">
<span class="sig-name descname"><span class="pre">__matmul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.__matmul__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.__matmul__" title="Link to this definition">¶</a></dt>
<dd><p>Matrix multiplication of the current complex tensor with another one
:param other: another complex tensor to be matrix-multiplied</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.__mul__">
<span class="sig-name descname"><span class="pre">__mul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.__mul__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.__mul__" title="Link to this definition">¶</a></dt>
<dd><p>element-wise multiplication of the current complex tensor with another one
:param other: another complex tensor to be multiplied</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.__add__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.__add__" title="Link to this definition">¶</a></dt>
<dd><p>element-wise addition of the current complex tensor with another one
:param other: another complex tensor to be added</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.__truediv__">
<span class="sig-name descname"><span class="pre">__truediv__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.__truediv__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.__truediv__" title="Link to this definition">¶</a></dt>
<dd><p>element-wise division of the current complex tensor with another one
:param other: another complex tensor to be added</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.get_intensity">
<span class="sig-name descname"><span class="pre">get_intensity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.get_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.get_intensity" title="Link to this definition">¶</a></dt>
<dd><p>intensity of the current tensor based on its polar coordinate
:returns: tensor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.conj">
<span class="sig-name descname"><span class="pre">conj</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.conj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.conj" title="Link to this definition">¶</a></dt>
<dd><p>complex conjugate of the tensor
:returns: tensor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.visualize" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the complex tensor
:param b: batch index to visualize default is 0
:param c: channel index to visualize. default is 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.complex.Complex.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#Complex.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.Complex.save" title="Link to this definition">¶</a></dt>
<dd><p>save the complex tensor as a file
:param fn: filename to save. the format should be either “npy” or “mat”</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.complex.vis_complex">
<span class="sig-name descname"><span class="pre">vis_complex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#vis_complex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.vis_complex" title="Link to this definition">¶</a></dt>
<dd><p>visualize the complex tensor in numpy based on amplitude and phase.
:param amin: minimum amplitude to visualize
:param amax: maximum amplitude to visualize</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy-based rgb visualization of the complex tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.complex.polar2rect">
<span class="sig-name descname"><span class="pre">polar2rect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#polar2rect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.polar2rect" title="Link to this definition">¶</a></dt>
<dd><p>convert polar representation to the rect representation
:param mag: magnitude of the complex tensor
:param ang: angle of the complex tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>real part of the complex tensor
imag: imaginary part of the complex tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>real</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.complex.rect2polar">
<span class="sig-name descname"><span class="pre">rect2polar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/complex.html#rect2polar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.complex.rect2polar" title="Link to this definition">¶</a></dt>
<dd><p>convert rect representation to the polar representation
:param real: real part of the complex tensor
:param imag: imaginary part of the complex tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>magnitude of the complex tensor
ang: angle of the complex tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>mag</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pado.conv">
<span id="pado-conv-module"></span><h2>pado.conv module<a class="headerlink" href="#module-pado.conv" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pado.conv.conv_fft">
<span class="sig-name descname"><span class="pre">conv_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/conv.html#conv_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.conv.conv_fft" title="Link to this definition">¶</a></dt>
<dd><p>Compute the convolution of an image with a convolution kernel using FFT
:param a: [B,Ch,R,C] input as Complex
:param b: [B,Ch,R,C] convolution kernel as Complex
:param pad_width: (tensor) pad width for the last spatial dimensions. should be (0,0,0,0) for circular convolution. for linear convolution, pad zero by the size of the original image</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>[B,Ch,R,C] convolved Complex</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>im_conv</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.conv.conv_fft_img_psf">
<span class="sig-name descname"><span class="pre">conv_fft_img_psf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">id='2590151268144'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">id='2590151720912'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">&lt;MagicMock</span> <span class="pre">id='2590151737008'&gt;</span></span></span><a class="reference internal" href="../_modules/pado/conv.html#conv_fft_img_psf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.conv.conv_fft_img_psf" title="Link to this definition">¶</a></dt>
<dd><p>Compute the convolution of an image with a PSF (Point Spread Function) using FFT
:param img: [B, Ch, R, C] image tensor
:param psf: [pB, 1, pR, pC] PSF tensor that is desired to be convolved with the image</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>[B, Ch, R, C] convolved image</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>im_conv</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pado.fourier">
<span id="pado-fourier-module"></span><h2>pado.fourier module<a class="headerlink" href="#module-pado.fourier" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pado.fourier.fft">
<span class="sig-name descname"><span class="pre">fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/fourier.html#fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.fourier.fft" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Fast Fourier transform of a complex tensor
:param arr_c: [B,Ch,R,C] complex tensor
:param normalized: Normalize the FFT output. default: False
:param pad_width: (tensor) pad width for the last spatial dimensions.
:param shift: flag for shifting the input data to make the zero-frequency located at the center of the arrc</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>[B,Ch,R,C] FFT of the input complex tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>arr_c_fft</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.fourier.ifft">
<span class="sig-name descname"><span class="pre">ifft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/fourier.html#ifft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.fourier.ifft" title="Link to this definition">¶</a></dt>
<dd><p>Compute the inverse Fast Fourier transform of a complex tensor
:param arr_c: [B,Ch,R,C] complex tensor
:param normalized: Normalize the FFT output. default: False
:param pad_width: (tensor) pad width for the last spatial dimensions.
:param shift: flag for inversely shifting the input data</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>[B,Ch,R,C] inverse FFT of the input complex tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>arr_c_fft</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.fourier.fftshift">
<span class="sig-name descname"><span class="pre">fftshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/fourier.html#fftshift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.fourier.fftshift" title="Link to this definition">¶</a></dt>
<dd><p>Shift the complex tensor so that the  zero-frequency signal located at the center of the input
:param arr_c: [B,Ch,R,C] complex tensor
:param invert: flag for inversely shifting the input data</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>[B,Ch,R,C] shifted tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>arr_c</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.fourier.ifftshift">
<span class="sig-name descname"><span class="pre">ifftshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/fourier.html#ifftshift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.fourier.ifftshift" title="Link to this definition">¶</a></dt>
<dd><p>Inversely shift the complex tensor
:param arr_c: [B,Ch,R,C] complex tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>[B,Ch,R,C] shifted tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>arr_c</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pado.light">
<span id="pado-light-module"></span><h2>pado.light module<a class="headerlink" href="#module-pado.light" title="Link to this heading">¶</a></h2>
<p>Light module for wave optics simulation.</p>
<p>This module provides the Light class that represents light waves with complex fields.
The Light class handles various wavefront representations and operations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pado.light.Light">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Light</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Light wave that has a complex field (B,Ch,R,C) as a wavefront.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> (<em>int</em>) – Number of rows</p></li>
<li><p><strong>C</strong> (<em>int</em>) – Number of columns</p></li>
<li><p><strong>pitch</strong> (<em>float</em>) – Pixel pitch in meters</p></li>
<li><p><strong>wvl</strong> (<em>float</em>) – Wavelength in meters</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Device to store the wavefront (‘cpu’, ‘cuda:0’, etc.)</p></li>
<li><p><strong>amplitude</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Wavefront amplitude tensor</p></li>
<li><p><strong>phase</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Wavefront phase tensor</p></li>
<li><p><strong>real</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Real part of wavefront</p></li>
<li><p><strong>imag</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Imaginary part of wavefront</p></li>
<li><p><strong>B</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size. Defaults to 1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Light wave that has a complex field (B,Ch,R,C) as a wavefront
It takes the input wavefront in one of the following types</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>amplitude and phase</p></li>
<li><p>real and imaginary</p></li>
<li><p>None ==&gt; we initialize light with amplitude of one and phase of zero</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> – row</p></li>
<li><p><strong>C</strong> – column</p></li>
<li><p><strong>pitch</strong> – pixel pitch in meter</p></li>
<li><p><strong>wvl</strong> – wavelength of light in meter</p></li>
<li><p><strong>device</strong> – device to store the wavefront of light. ‘cpu’, ‘cuda:0’, …</p></li>
<li><p><strong>amplitude</strong> – [batch_size, # of channels, row, column] tensor of wavefront amplitude, default is None</p></li>
<li><p><strong>phase</strong> – [batch_size, # of channels, row, column] tensor of wavefront amplitude, default is None</p></li>
<li><p><strong>real</strong> – [batch_size, # of channels, row, column] tensor of wavefront real part, default is None</p></li>
<li><p><strong>imag</strong> – [batch_size, # of channels, row, column] tensor of wavefront imaginary part, default is None</p></li>
<li><p><strong>B</strong> – batch size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crop_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.crop" title="Link to this definition">¶</a></dt>
<dd><p>Crop the light wavefront by crop_width
:param crop_width: (tuple) crop width of the tensor following torch functional pad</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.clone" title="Link to this definition">¶</a></dt>
<dd><p>Clone the light and return it</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.pad">
<span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.pad" title="Link to this definition">¶</a></dt>
<dd><p>Pad the light wavefront with a constant value by pad_width
:param pad_width: (tuple) pad width of the tensor following torch functional pad
:param padval: value to pad. default is zero</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_real">
<span class="sig-name descname"><span class="pre">set_real</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_real"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_real" title="Link to this definition">¶</a></dt>
<dd><p>Set the real part of the light wavefront
:param real: real part in the rect representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_imag">
<span class="sig-name descname"><span class="pre">set_imag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_imag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_imag" title="Link to this definition">¶</a></dt>
<dd><p>Set the imaginary part of the light wavefront
:param imag: imaginary part in the rect representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_amplitude">
<span class="sig-name descname"><span class="pre">set_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_amplitude" title="Link to this definition">¶</a></dt>
<dd><p>Set the amplitude of the light wavefront
:param amplitude: amplitude in the polar representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_phase">
<span class="sig-name descname"><span class="pre">set_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_phase" title="Link to this definition">¶</a></dt>
<dd><p>Set the phase of the complex tensor
:param phase: phase in the polar representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_field">
<span class="sig-name descname"><span class="pre">set_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_field" title="Link to this definition">¶</a></dt>
<dd><p>Set the wavefront modulation of the complex tensor
:param field: wavefront as a complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_pitch">
<span class="sig-name descname"><span class="pre">set_pitch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_pitch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_pitch" title="Link to this definition">¶</a></dt>
<dd><p>Set the pixel pitch of the complex tensor
:param pitch: pixel pitch in meter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.get_amplitude">
<span class="sig-name descname"><span class="pre">get_amplitude</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.get_amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.get_amplitude" title="Link to this definition">¶</a></dt>
<dd><p>Return the amplitude of the wavefront
:returns: magnitude in the polar representation of the complex number
:rtype: mag</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.get_phase">
<span class="sig-name descname"><span class="pre">get_phase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.get_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.get_phase" title="Link to this definition">¶</a></dt>
<dd><p>Return the phase of the wavefront
:returns: angle in the polar representation of the complex number
:rtype: ang</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.get_field">
<span class="sig-name descname"><span class="pre">get_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.get_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.get_field" title="Link to this definition">¶</a></dt>
<dd><p>Return the complex wavefront
:returns: complex wavefront
:rtype: field</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.get_intensity">
<span class="sig-name descname"><span class="pre">get_intensity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.get_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.get_intensity" title="Link to this definition">¶</a></dt>
<dd><p>Return the intensity of light wavefront
:returns: intensity of light
:rtype: intensity</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.get_bandwidth">
<span class="sig-name descname"><span class="pre">get_bandwidth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.get_bandwidth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.get_bandwidth" title="Link to this definition">¶</a></dt>
<dd><p>Get the bandwidth of the light wave.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The bandwidth in meters^-1</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.magnify">
<span class="sig-name descname"><span class="pre">magnify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.magnify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.magnify" title="Link to this definition">¶</a></dt>
<dd><p>Change the wavefront resolution without changing the pixel pitch
:param scale_factor: scale factor for interpolation used in tensor.nn.functional.interpolate
:param interp_mode: interpolation method used in torch.nn.functional.interpolate ‘bilinear’, ‘nearest’</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.resize">
<span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.resize" title="Link to this definition">¶</a></dt>
<dd><p>Resize the wavefront by changing the pixel pitch.
:param target_pitch: new pixel pitch to use
:param interp_mode: interpolation method used in torch.nn.functional.interpolate ‘bilinear’, ‘nearest’</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_spherical_light">
<span class="sig-name descname"><span class="pre">set_spherical_light</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_spherical_light"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_spherical_light" title="Link to this definition">¶</a></dt>
<dd><p>Set the wavefront as spherical one coming from the position of (dx,dy,z).
:param z: z distance of the spherical light source from the current light position
:param dx: x distance of the spherical light source from the current light position
:param dy: y distance of the spherical light source from the current light position</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.set_plane_light">
<span class="sig-name descname"><span class="pre">set_plane_light</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.set_plane_light"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.set_plane_light" title="Link to this definition">¶</a></dt>
<dd><p>Set the wavefront as a plane wave with zero phase and amptliude of one</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.save" title="Link to this definition">¶</a></dt>
<dd><p>Save the amplitude and phase of the light wavefront as a file
:param fn: filename to save. the format should be either “npy” or “mat”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.visualize" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the light wave
:param b: batch index to visualize default is 0
:param c: channel index to visualize. default is 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.light.Light.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/light.html#Light.shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.light.Light.shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of light wavefront
:returns: shape</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pado.material">
<span id="pado-material-module"></span><h2>pado.material module<a class="headerlink" href="#module-pado.material" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pado.material.Material">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Material</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">material_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/material.html#Material"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.material.Material" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pado.material.Material.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">material_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/material.html#Material.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.material.Material.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Material of optical elements and its refractive index.
:param material name: name of the material. So far, we provide PDMS, FUSED_SILICA, VACCUM.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.material.Material.get_RI">
<span class="sig-name descname"><span class="pre">get_RI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/material.html#Material.get_RI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.material.Material.get_RI" title="Link to this definition">¶</a></dt>
<dd><p>Return the refractive index of the current material for a wavelength
:param wvl: wavelength in meter</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Refractive index at wvl</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>RI</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pado.optical_element">
<span id="pado-optical-element-module"></span><h2>pado.optical_element module<a class="headerlink" href="#module-pado.optical_element" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OpticalElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'not</span> <span class="pre">defined'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'not</span> <span class="pre">defined'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Base class for optical elements. Any optical element change the wavefront of incident light
The change of the wavefront is stored as amplitude and phase tensors
Note that he number of channels is one for the wavefront modulation.
:param R: row
:param C: column
:param pitch: pixel pitch in meter
:param wvl: wavelength of light in meter
:param device: device to store the wavefront of light. ‘cpu’, ‘cuda:0’, …
:param name: name of the current optical element
:param B: batch size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of light-wavefront modulation. The nunmber of channels is one
:returns: shape</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.set_pitch">
<span class="sig-name descname"><span class="pre">set_pitch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.set_pitch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.set_pitch" title="Link to this definition">¶</a></dt>
<dd><p>Set the pixel pitch of the complex tensor
:param pitch: pixel pitch in meter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.resize">
<span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.resize" title="Link to this definition">¶</a></dt>
<dd><p>Resize the wavefront change by changing the pixel pitch.
:param target_pitch: new pixel pitch to use
:param interp_mode: interpolation method used in torch.nn.functional.interpolate ‘bilinear’, ‘nearest’</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.get_amplitude_change">
<span class="sig-name descname"><span class="pre">get_amplitude_change</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.get_amplitude_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.get_amplitude_change" title="Link to this definition">¶</a></dt>
<dd><p>Return the amplitude change of the wavefront
:returns: ampiltude change
:rtype: amplitude change</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.get_phase_change">
<span class="sig-name descname"><span class="pre">get_phase_change</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.get_phase_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.get_phase_change" title="Link to this definition">¶</a></dt>
<dd><p>Return the phase change of the wavefront
:returns: phase change
:rtype: phase change</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.set_amplitude_change">
<span class="sig-name descname"><span class="pre">set_amplitude_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.set_amplitude_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.set_amplitude_change" title="Link to this definition">¶</a></dt>
<dd><p>Set the amplitude change
:param amplitude change: amplitude change in the polar representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.set_phase_change">
<span class="sig-name descname"><span class="pre">set_phase_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.set_phase_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.set_phase_change" title="Link to this definition">¶</a></dt>
<dd><p>Set the phase change
:param phase change: phase change in the polar representation of the complex number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.pad">
<span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.pad" title="Link to this definition">¶</a></dt>
<dd><p>Pad the wavefront change with a constant value by pad_width
:param pad_width: (tuple) pad width of the tensor following torch functional pad
:param padval: value to pad. default is zero</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward the incident light with the optical element.
:param light: incident light
:param interp_mode: interpolation method used in torch.nn.functional.interpolate ‘bilinear’, ‘nearest’</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>light after interaction with the optical element</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.OpticalElement.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#OpticalElement.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.OpticalElement.visualize" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the wavefront modulation of the optical element
:param b: batch index to visualize default is 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pado.optical_element.RefractiveLens">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RefractiveLens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#RefractiveLens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.RefractiveLens" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pado.optical_element.OpticalElement" title="pado.optical_element.OpticalElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.RefractiveLens.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#RefractiveLens.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.RefractiveLens.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Thin refractive lens
:param R: row
:param C: column
:param pitch: pixel pitch in meter
:param focal_length: focal length of the lens in meter
:param wvl: wavelength of light in meter
:param device: device to store the wavefront of light. ‘cpu’, ‘cuda:0’, …</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.RefractiveLens.set_focal_length">
<span class="sig-name descname"><span class="pre">set_focal_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">focal_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#RefractiveLens.set_focal_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.RefractiveLens.set_focal_length" title="Link to this definition">¶</a></dt>
<dd><p>Set the focal length of the lens
:param focal_length: focal length in meter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.RefractiveLens.compute_phase">
<span class="sig-name descname"><span class="pre">compute_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#RefractiveLens.compute_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.RefractiveLens.compute_phase" title="Link to this definition">¶</a></dt>
<dd><p>Set the phase of a thin lens
:param wvl: wavelength of light in meter
:param shift_x: x displacement of the lens w.r.t. incident light
:param shift_y: y displacement of the lens w.r.t. incident light</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.optical_element.height2phase">
<span class="sig-name descname"><span class="pre">height2phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#height2phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.height2phase" title="Link to this definition">¶</a></dt>
<dd><p>Convert the height of a material to the corresponding phase shift
:param height: height of the material in meter
:param wvl: wavelength of light in meter
:param RI: refractive index of the material at the wavelength
:param wrap: return the wrapped phase [0,2pi]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.optical_element.phase2height">
<span class="sig-name descname"><span class="pre">phase2height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RI</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#phase2height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.phase2height" title="Link to this definition">¶</a></dt>
<dd><p>Convert the phase change to the height of a material
:param phase: phase change of light
:param wvl: wavelength of light in meter
:param RI: refractive index of the material at the wavelength</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.optical_element.radius2phase">
<span class="sig-name descname"><span class="pre">radius2phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#radius2phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.radius2phase" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pado.optical_element.DOE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DOE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">material</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pado.optical_element.OpticalElement" title="pado.optical_element.OpticalElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">material</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Diffractive optical element (DOE)
:param R: row
:param C: column
:param pitch: pixel pitch in meter
:param material: material of the DOE
:param wvl: wavelength of light in meter
:param device: device to store the wavefront of light. ‘cpu’, ‘cuda:0’, …
:param height: height map of the material in meter
:param phase: phase change of light
:param amplitude: amplitude change of light</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.change_wvl">
<span class="sig-name descname"><span class="pre">change_wvl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.change_wvl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.change_wvl" title="Link to this definition">¶</a></dt>
<dd><p>Change the wavelength of phase change
:param wvl: wavelength of phase change</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.set_diffraction_grating_1d">
<span class="sig-name descname"><span class="pre">set_diffraction_grating_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slit_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.set_diffraction_grating_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.set_diffraction_grating_1d" title="Link to this definition">¶</a></dt>
<dd><p>Set the wavefront modulation as 1D diffraction grating
:param slit_width: width of slit in meter
:param minh: minimum height in meter
:param maxh: maximum height in meter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.set_diffraction_grating_2d">
<span class="sig-name descname"><span class="pre">set_diffraction_grating_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slit_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.set_diffraction_grating_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.set_diffraction_grating_2d" title="Link to this definition">¶</a></dt>
<dd><p>Set the wavefront modulation as 2D diffraction grating
:param slit_width: width of slit in meter
:param minh: minimum height in meter
:param maxh: maximum height in meter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.set_Fresnel_lens">
<span class="sig-name descname"><span class="pre">set_Fresnel_lens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">focal_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.set_Fresnel_lens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.set_Fresnel_lens" title="Link to this definition">¶</a></dt>
<dd><p>Set the wavefront modulation as a fresnel lens
:param focal_length: focal length in meter
:param shift_x: x displacement of the lens w.r.t. incident light
:param shift_y: y displacement of the lens w.r.t. incident light</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.resize">
<span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_pitch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.resize" title="Link to this definition">¶</a></dt>
<dd><p>Resize the wavefront by changing the pixel pitch.
:param target_pitch: new pixel pitch to use</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.get_height">
<span class="sig-name descname"><span class="pre">get_height</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.get_height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.get_height" title="Link to this definition">¶</a></dt>
<dd><p>Return the height map of the DOE
:returns: height map in meter
:rtype: height map</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.get_phase_change">
<span class="sig-name descname"><span class="pre">get_phase_change</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.get_phase_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.get_phase_change" title="Link to this definition">¶</a></dt>
<dd><p>Return the phase change induced by the DOE
:returns: phase change
:rtype: phase change</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.set_height">
<span class="sig-name descname"><span class="pre">set_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.set_height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.set_height" title="Link to this definition">¶</a></dt>
<dd><p>Set the height map of the DOE
:param height map: height map in meter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.set_phase_change">
<span class="sig-name descname"><span class="pre">set_phase_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase_change</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.set_phase_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.set_phase_change" title="Link to this definition">¶</a></dt>
<dd><p>Set the phase change induced by the DOE
:param phase change: phase change</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.to_phase_mode">
<span class="sig-name descname"><span class="pre">to_phase_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.to_phase_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.to_phase_mode" title="Link to this definition">¶</a></dt>
<dd><p>Change the mode to phase change</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.DOE.to_height_mode">
<span class="sig-name descname"><span class="pre">to_height_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#DOE.to_height_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.DOE.to_height_mode" title="Link to this definition">¶</a></dt>
<dd><p>Change the mode to height</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pado.optical_element.SLM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SLM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#SLM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.SLM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pado.optical_element.OpticalElement" title="pado.optical_element.OpticalElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.SLM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#SLM.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.SLM.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Spatial light modulator (SLM)
:param R: row
:param C: column
:param pitch: pixel pitch in meter
:param wvl: wavelength of light in meter
:param device: device to store the wavefront of light. ‘cpu’, ‘cuda:0’, …
:param B: batch size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.SLM.set_lens">
<span class="sig-name descname"><span class="pre">set_lens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">focal_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#SLM.set_lens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.SLM.set_lens" title="Link to this definition">¶</a></dt>
<dd><p>Set the phase of a thin lens
:param wvl: wavelength of light in meter
:param shift_x: x displacement of the lens w.r.t. incident light
:param shift_y: y displacement of the lens w.r.t. incident light</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.SLM.set_amplitude_change">
<span class="sig-name descname"><span class="pre">set_amplitude_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#SLM.set_amplitude_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.SLM.set_amplitude_change" title="Link to this definition">¶</a></dt>
<dd><p>Set the amplitude change
:param amplitude change: amplitude change in the polar representation of the complex number
:param wvl: wavelength of light in meter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.SLM.set_phase_change">
<span class="sig-name descname"><span class="pre">set_phase_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase_change</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#SLM.set_phase_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.SLM.set_phase_change" title="Link to this definition">¶</a></dt>
<dd><p>Set the phase change
:param phase change: phase change in the polar representation of the complex number
:param wvl: wavelength of light in meter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pado.optical_element.Aperture">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Aperture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aperture_diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aperture_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#Aperture"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.Aperture" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pado.optical_element.OpticalElement" title="pado.optical_element.OpticalElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.Aperture.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aperture_diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aperture_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#Aperture.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.Aperture.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Aperture
:param R: row
:param C: column
:param pitch: pixel pitch in meter
:param aperture_diameter: diamater of the aperture in meter
:param aperture_shape: shape of the aperture. {‘square’, ‘circle’}
:param wvl: wavelength of light in meter
:param device: device to store the wavefront of light. ‘cpu’, ‘cuda:0’, …</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.Aperture.set_square">
<span class="sig-name descname"><span class="pre">set_square</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#Aperture.set_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.Aperture.set_square" title="Link to this definition">¶</a></dt>
<dd><p>Set the amplitude modulation of the aperture as square</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.optical_element.Aperture.set_circle">
<span class="sig-name descname"><span class="pre">set_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dia</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#Aperture.set_circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.Aperture.set_circle" title="Link to this definition">¶</a></dt>
<dd><p>Set the amplitude modulation of the aperture as circle
:param cx: relative center position of the circle with respect to the center of the light wavefront
:param cy: relative center position of the circle with respect to the center of the light wavefront
:param dia: circle diameter</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.optical_element.quantize">
<span class="sig-name descname"><span class="pre">quantize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/optical_element.html#quantize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.optical_element.quantize" title="Link to this definition">¶</a></dt>
<dd><p>Quantize the floating array
:param levels: number of quantization levels
:param vmin: minimum value for quantization
:param vmax: maximum value for quantization
:param include_vmax: include vmax for the quantized levels</p>
<blockquote>
<div><p>False: quantize x with the space of 1/levels-1.
True: quantize x with the space of 1/levels</p>
</div></blockquote>
</dd></dl>

</section>
<section id="module-pado.propagator">
<span id="pado-propagator-module"></span><h2>pado.propagator module<a class="headerlink" href="#module-pado.propagator" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pado.propagator.compute_pad_width">
<span class="sig-name descname"><span class="pre">compute_pad_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#compute_pad_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.compute_pad_width" title="Link to this definition">¶</a></dt>
<dd><p>Compute the pad width of an array for FFT-based convolution
:param field: (B,Ch,R,C) complex tensor
:param linear: True or False, flag for linear convolution (zero padding) or circular convolution (no padding)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>pad-width tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pad_width</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.propagator.unpad">
<span class="sig-name descname"><span class="pre">unpad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_padded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#unpad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.unpad" title="Link to this definition">¶</a></dt>
<dd><p>Unpad the already-padded complex tensor
:param field_padded: (B,Ch,R,C) padded complex tensor
:param pad_width: pad-width tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>unpadded complex tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.propagator.fresnel_number">
<span class="sig-name descname"><span class="pre">fresnel_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#fresnel_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.fresnel_number" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Fresnel Number to determine propagation method
:param wid: physical width of the light
:param z: propagation distance
:param wvl: wavelength of the light</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fresnel Number</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pado.propagator.critical_sampling">
<span class="sig-name descname"><span class="pre">critical_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#critical_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.critical_sampling" title="Link to this definition">¶</a></dt>
<dd><p>Calculate critical sampling to determine
Impulse Response or Transfer Function for Fresnel
:param z: propagation distance
:param wvl: wavelength of the light
:param length: array length of the light</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Critical Sampling</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pado.propagator.Propagator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Propagator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#Propagator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.Propagator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pado.propagator.Propagator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#Propagator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.Propagator.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Free-space propagator of light waves
One can simulate the propagation of light waves on free space (no medium change at all).
:param mode: type of propagator. currently, we support “Fraunhofer” propagation or “Fresnel” propagation. Use Fraunhofer for far-field propagation and Fresnel for near-field propagation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.propagator.Propagator.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#Propagator.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.Propagator.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward the incident light with the propagator.
:param light: incident light
:param z: propagation distance in meter
:param linear: True or False, flag for linear convolution (zero padding) or circular convolution (no padding)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>light after propagation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>light</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.propagator.Propagator.forward_Fraunhofer">
<span class="sig-name descname"><span class="pre">forward_Fraunhofer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#Propagator.forward_Fraunhofer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.Propagator.forward_Fraunhofer" title="Link to this definition">¶</a></dt>
<dd><p>Simulate Fraunhofer diffraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>light</strong> (<a class="reference internal" href="#pado.light.Light" title="pado.light.Light"><em>Light</em></a>) – Input light wave</p></li>
<li><p><strong>z</strong> (<em>float</em>) – Propagation distance in meters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Propagated light wave</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pado.light.Light" title="pado.light.Light"><em>Light</em></a></p>
</dd>
</dl>
<p>The Fraunhofer diffraction is calculated using the Fourier transform method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.propagator.Propagator.forward_Fresnel">
<span class="sig-name descname"><span class="pre">forward_Fresnel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#Propagator.forward_Fresnel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.Propagator.forward_Fresnel" title="Link to this definition">¶</a></dt>
<dd><p>Forward the incident light with the Fresnel propagator.
:param light: incident light
:param z: propagation distance in meter.
:param linear: True or False, flag for linear convolution (zero padding) or circular convolution (no padding)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>light after propagation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>light</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pado.propagator.Propagator.forward_asm">
<span class="sig-name descname"><span class="pre">forward_asm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pado/propagator.html#Propagator.forward_asm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pado.propagator.Propagator.forward_asm" title="Link to this definition">¶</a></dt>
<dd><p>Forward the incident light with the ASM propagator.
:param light: incident light
:param z: propagation distance in meter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>light after propagation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>light</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pado">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pado" title="Link to this heading">¶</a></h2>
<p>Pado: Differentiable Light-wave Simulation.</p>
<p>Pado is a differentiable wave-optics library written in PyTorch.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pado</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html#creating-light">Creating Light</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html#using-optical-elements">Using Optical Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html#simulating-propagation">Simulating Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html#visualizing-results">Visualizing Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Seung-Hwan Baek, Yujin Jeon, Dong-ha Shin.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/api/pado.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>